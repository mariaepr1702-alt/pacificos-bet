<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Administrativo - PAC칈FICOS BET</title>

<style>
body{
    margin:0;
    font-family:Arial;
    background:#0b0b1c;
    color:white;
}
.container{display:flex;}
.menu{
    width:260px;
    background:#000;
    height:100vh;
    padding:20px;
}
.menu h2{
    color:#ffcc00;
    text-align:center;
}
.menu button{
    width:100%;
    padding:12px;
    margin-top:8px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
    background:#1b1b3a;
    color:white;
}
.menu button:hover{background:#ffcc00;color:black;}
.logout{background:red !important;}

.content{flex:1;padding:20px;}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
}
th,td{
    border:1px solid #555;
    padding:8px;
    text-align:center;
}
th{
    background:#ffcc00;
    color:black;
}

.page{display:none;}
.page.active{display:block;}

.btn{
    padding:6px 10px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}
.aprovar{background:#2ecc71;color:white;}
.excluir{background:#e74c3c;color:white;}
</style>
</head>

<body>

<div class="container">

<!-- MENU -->
<div class="menu">
    <h2>游 ADMIN</h2>
    <button onclick="showPage('dashboard')">游늵 Dashboard</button>
    <button onclick="showPage('usuarios')">游논 Usu치rios</button>
    <button onclick="showPage('financeiro')">游눯 Dep칩sitos</button>
    <button onclick="sair()" class="logout">游뛁 Sair</button>
</div>

<!-- CONTE칔DO -->
<div class="content">

<!-- DASHBOARD -->
<div id="dashboard" class="page active">
    <h1>游늵 Dashboard</h1>
    <p>Total de usu치rios: <b id="totalUsuarios">0</b></p>
    <p>Saldo total do sistema: <b>R$ <span id="saldoTotal">0,00</span></b></p>
</div>

<!-- USU츼RIOS -->
<div id="usuarios" class="page">
    <h1>游논 Usu치rios</h1>
    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Email</th>
                <th>Saldo</th>
            </tr>
        </thead>
        <tbody id="listaUsuarios"></tbody>
    </table>
</div>

<!-- DEP칍SITOS -->
<div id="financeiro" class="page">
    <h1>游눯 Dep칩sitos Pendentes</h1>
    <table>
        <thead>
            <tr>
                <th>Usu치rio</th>
                <th>Email</th>
                <th>Valor</th>
                <th>CPF</th>
                <th>A칞칚o</th>
            </tr>
        </thead>
        <tbody id="listaDepositos"></tbody>
    </table>
</div>

</div>
</div>

<script>
/* ===== PROTE칂츾O ===== */
let logado = localStorage.getItem("logged");
let usuario = JSON.parse(localStorage.getItem("usuarioLogado"));
let adminEmail = "mariaepr1702@gmail.com";

if(logado !== "true" || !usuario || usuario.email !== adminEmail){
    alert("Acesso negado!");
    window.location.href="index.html";
}

/* ===== DADOS ===== */
let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
let depositos = JSON.parse(localStorage.getItem("depositos")) || [];

/* ===== DASHBOARD ===== */
document.getElementById("totalUsuarios").innerText = usuarios.length;

let soma = 0;
usuarios.forEach(u => soma += Number(u.saldo || 0));
document.getElementById("saldoTotal").innerText = soma.toFixed(2);

/* ===== LISTAR USU츼RIOS ===== */
let listaUsuarios = document.getElementById("listaUsuarios");
usuarios.forEach(u=>{
    let tr = document.createElement("tr");
    tr.innerHTML = `
        <td>${u.nome}</td>
        <td>${u.email}</td>
        <td>R$ ${(u.saldo || 0).toFixed(2)}</td>
    `;
    listaUsuarios.appendChild(tr);
});

/* ===== LISTAR DEP칍SITOS ===== */
let listaDepositos = document.getElementById("listaDepositos");

function renderDepositos(){
    listaDepositos.innerHTML="";

    let pendentes = depositos.filter(d => d.status === "Pendente");

    if(pendentes.length === 0){
        listaDepositos.innerHTML = `<tr><td colspan="5">Nenhum dep칩sito pendente</td></tr>`;
        return;
    }

    pendentes.forEach((d,i)=>{
        let tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${d.nome}</td>
            <td>${d.email}</td>
            <td>R$ ${Number(d.valor).toFixed(2)}</td>
            <td>${d.cpf}</td>
            <td>
                <button class="btn aprovar" onclick="aprovar(${i})">Aprovar</button>
                <button class="btn excluir" onclick="excluir(${i})">Excluir</button>
            </td>
        `;
        listaDepositos.appendChild(tr);
    });
}
renderDepositos();

/* ===== APROVAR ===== */
function aprovar(index){
    let pendentes = depositos.filter(d => d.status === "Pendente");
    let dep = pendentes[index];

    let user = usuarios.find(u => u.email === dep.email);
    if(!user){
        alert("Usu치rio n칚o encontrado");
        return;
    }

    user.saldo = Number(user.saldo || 0) + Number(dep.valor);
    dep.status = "Aprovado";

    localStorage.setItem("usuarios", JSON.stringify(usuarios));
    localStorage.setItem("depositos", JSON.stringify(depositos));

    alert("Dep칩sito aprovado!");
    location.reload();
}

/* ===== EXCLUIR ===== */
function excluir(index){
    let pendentes = depositos.filter(d => d.status === "Pendente");
    let dep = pendentes[index];

    let pos = depositos.indexOf(dep);
    depositos.splice(pos,1);

    localStorage.setItem("depositos", JSON.stringify(depositos));
    alert("Dep칩sito exclu칤do");
    location.reload();
}

/* ===== NAVEGA칂츾O ===== */
function showPage(id){
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    document.getElementById(id).classList.add("active");
}

/* ===== SAIR ===== */
function sair(){
    localStorage.clear();
    window.location.href="login.html";
}
</script>

</body>
</html>
